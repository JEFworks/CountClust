<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Countclust by kkdey</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Countclust</h1>
        <p>A R package for counts clustering</p>

        <p class="view"><a href="https://github.com/kkdey/CountClust">View the Project on GitHub <small>kkdey/CountClust</small></a></p>


        <ul>
          <li><a href="https://github.com/kkdey/CountClust/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kkdey/CountClust/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kkdey/CountClust">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="countclust" class="anchor" href="#countclust" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CountClust</h1>

<p>A R package for counts clustering-</p>

<p><a href="http://kkdey.github.io/">Kushal K Dey</a>, <a href="http://cbcb.umd.edu/%7Echsiao/">Chiaowen Joyce Hsiao</a>, <a href="http://stephenslab.uchicago.edu/">Matthew Stephens</a></p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p><code>CountClust</code> requires the <code>limma</code> package from <a href="https://bioconductor.org/packages/release/bioc/html/limma.html">Bioconductor</a>:</p>

<pre><code>source("http://bioconductor.org/biocLite.R")
biocLite("limma")
</code></pre>

<p>To download and install this package,</p>

<pre><code>install.packages("devtools")
library(devtools)
install_github("kkdey/CountClust")
</code></pre>

<p>Load the package in R</p>

<pre><code>library(CountClust)
</code></pre>

<h2>
<a id="application-of-countclust" class="anchor" href="#application-of-countclust" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Application of CountClust</h2>

<p>Load the counts data (samples along the rows, variables or features along the columns) in R. Here we use a test data comprising of the brain samples in GTEX V6 data</p>

<pre><code>brain_data &lt;- t(data.frame(data.table::fread("test/cis_gene_expression_brain.txt"))[,-(1:2)]);
</code></pre>

<p>Next we load the brain metadata</p>

<pre><code>brain_labels &lt;- as.vector((read.table("metadata_brain.txt")[,3]));

</code></pre>

<h3>
<a id="model-fit" class="anchor" href="#model-fit" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Model fit</h3>

<p>We  apply the StructureObj function to fit the topic model (due to the <strong>maptpx</strong> package of Matt Taddy) for clusters 2 and 3. </p>

<pre><code>if(!dir.exists("test/Structure")) dir.create("test/Structure")
StructureObj(brain_data, nclus_vec=2:3, tol=0.1, path_rda="test/topics_data.rda")
</code></pre>

<p>This function will output a rda file containing a list of size 2 (corresponding to clusters 2 and 3). Each element of the list is a topic model class (as defined by <code>topics()</code> function in  <code>maptpx</code> package) and contains the W (the topic proportion matrix) and T (topic distribution) files.</p>

<h3>
<a id="cluster-visualization" class="anchor" href="#cluster-visualization" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cluster Visualization</h3>

<p>One can plot the W matrix using a Structure plot. Here we provide an example of the Structure plot for K=3 for the above topic model fit. </p>

<pre><code>Topic_clus &lt;- get(load("topics_data.rda"));
omega &lt;- Topic_clus$clust_3$omega;

rownames(omega) &lt;- paste0("X", 1:length(brain_labels))
annotation &lt;- data.frame(
  sample_id = paste0("X", 1:length(brain_labels)),
  tissue_label = factor(brain_labels,
                        levels = rev(unique(brain_labels)) ) )


cols &lt;- c("blue", "darkgoldenrod1", "cyan")


StructureGGplot(omega = omega,
                annotation= annotation,
                palette = cols,
                yaxis_label = "",
                order_sample = TRUE,
                split_line = list(split_lwd = .4,
                                  split_col = "white"),
                axis_tick = list(axis_ticks_length = .1,
                                 axis_ticks_lwd_y = .1,
                                 axis_ticks_lwd_x = .1,
                                 axis_label_size = 10,
                                 axis_label_face = "bold"))

</code></pre>

<p><img src="https://github.com/kkdey/CountClust/blob/master/test/structure_plot.png" alt="Structure Plot" height="900" width="400"></p>

<h3>
<a id="cluster-annotations" class="anchor" href="#cluster-annotations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cluster annotations</h3>

<p>We can extract the features that drive the clusters for K=3 as follows </p>

<pre><code>theta &lt;- Topic_clus$clust_3$theta;
features &lt;- ExtractTopFeatures(theta,top_features=50, method="poisson", options="min")
</code></pre>

<p>It will provide you with a list of top 50 variables/features per cluster that are relatively most highly expressed in that cluster compared to the other clusters, or in other words, plays the most important role in driving or separating out that cluster from the rest. </p>

<h2>
<a id="licenses" class="anchor" href="#licenses" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Licenses</h2>

<p>The CountClust package is distributed under [GPL - General Public License (&gt;= 2)]</p>

<h2>
<a id="contact" class="anchor" href="#contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contact</h2>

<p>For any queries, contact <a href="kkdey@uchicago.edu">kkdey@uchicago.edu</a></p>

<h2>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Acknowledgements</h2>

<ul>
<li>Raman Shah</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/kkdey">kkdey</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
