{"name":"Countclust","tagline":"A R package for counts clustering","body":"# CountClust\r\nA R package for Grade of Membership (GoM) model fit and Visualization of counts data-\r\n\r\n[Kushal K Dey](http://kkdey.github.io/), [Chiaowen Joyce Hsiao](http://cbcb.umd.edu/~chsiao/), [Matthew Stephens](http://stephenslab.uchicago.edu/)\r\n\r\n\r\n## Installation\r\n\r\n`CountClust` requires the following CRAN-R packages: `maptpx`, `slam`, `ggplot2`, `cowplot`, `parallel` along with the Bioconductor package: `limma`.\r\n\r\n```\r\ninstall.packages(\"CountClust\")\r\n```\r\n\r\nFor installing the working version of this package and loading the data required for this vignette, we use CRAN-R package `devtools`.\r\n\r\n```\r\nlibrary(devtools)\r\ninstall_github('kkdey/CountClust')\r\n```\r\n\r\nThen load the package with:\r\n\r\n```\r\nlibrary(CountClust)\r\n```\r\n\r\n## Application of CountClust\r\n\r\nWe load the single cell RNA-seq data due to [Deng et al 2014](http://www.ncbi.nlm.nih.gov/pubmed/24408435). The data contains RNA-seq read counts for single cells at different stages of mouse embryo development (from zygote to blastocyst). \r\n\r\n```\r\nlibrary(singleCellRNASeqMouseDeng2014)\r\ndeng.counts <- exprs(Deng2014MouseESC)\r\ndeng.meta_data <- pData(Deng2014MouseESC)\r\ndeng.gene_names <- rownames(deng.counts)\r\n```\r\n\r\n### GoM Model fit \r\n\r\nWe apply the `StructureObj` function (which is a wrapper of the `topics` function in the maptpx package) for a vector of number of clusters, ranging from 2 to 7. \r\n\r\n```\r\nFitGoM(t(deng.counts),\r\n            K=c(3,6), tol=0.1,\r\n            path_rda=\"data/MouseDeng2014.FitGoM.rda\")\r\n```\r\n\r\nThis function will output a list, each element representing a GoM model fit output for a particular cluster number. \r\n\r\n### Cluster Visualization\r\n\r\nOne can plot the `omega` from the `StructureObj` fit using a Structure plot. Here we provide an example of the Structure plot for K=6 for the above GoM model fit. \r\n\r\n```\r\ndata(\"MouseDeng2014.FitGoM\")\r\nnames(MouseDeng2014.FitGoM)\r\nomega <- MouseDeng2014.FitGoM$clust_6$omega\r\n\r\n\r\nannotation <- data.frame(\r\n  sample_id = paste0(\"X\", c(1:NROW(omega))),\r\n  tissue_label = factor(rownames(omega),\r\n                        levels = rev( c(\"zy\", \"early2cell\",\r\n                                        \"mid2cell\", \"late2cell\",\r\n                                        \"4cell\", \"8cell\", \"16cell\",\r\n                                        \"earlyblast\",\"midblast\",\r\n                                         \"lateblast\") ) ) )\r\n\r\nrownames(omega) <- annotation$sample_id;\r\n\r\nStructureGGplot(omega = omega,\r\n                annotation = annotation,\r\n                palette = RColorBrewer::brewer.pal(8, \"Accent\"),\r\n                yaxis_label = \"Amplification batch\",\r\n                order_sample = TRUE,\r\n                axis_tick = list(axis_ticks_length = .1,\r\n                                 axis_ticks_lwd_y = .1,\r\n                                 axis_ticks_lwd_x = .1,\r\n                                 axis_label_size = 7,\r\n                                 axis_label_face = \"bold\"))\r\n\r\n```\r\n\r\n<img src=\"vignettes/structure_plot.png\" alt=\"Structure Plot\" height=\"700\" width=\"400\">\r\n\r\n\r\n### Cluster annotations\r\n\r\nWe can extract the features that drive the clusters for K=6 as follows \r\n\r\n```\r\ntheta_mat <- MouseDeng2014.topicFit$clust_6$theta;\r\ntop_features <- ExtractTopFeatures(theta_mat, top_features=100,\r\n                                   method=\"poisson\", options=\"min\");\r\ngene_list <- do.call(rbind, lapply(1:dim(top_features)[1],\r\n                        function(x) deng.gene_names[top_features[x,]]))\r\n```\r\nIt will provide you with a list of top 100 variables/features per cluster that are relatively most highly expressed in that cluster compared to the other clusters, or in other words, plays the most important role in driving or separating out that cluster from the rest. \r\n\r\n\r\n## Licenses\r\n\r\nThe CountClust package is distributed under [GPL - General Public License (>= 2)]\r\n\r\n## Contact\r\n\r\nFor any queries, contact [kkdey@uchicago.edu](kkdey@uchicago.edu)\r\n\r\n## Acknowledgements\r\n\r\n- Raman Shah\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}