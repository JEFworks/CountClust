{"name":"Countclust","tagline":"A R package for counts clustering","body":"# CountClust\r\nA R package for counts clustering-\r\n\r\n[Kushal K Dey](http://kkdey.github.io/), [Chiaowen Joyce Hsiao](http://cbcb.umd.edu/~chsiao/), [Matthew Stephens](http://stephenslab.uchicago.edu/)\r\n\r\n\r\n## Installation\r\n\r\n`CountClust` requires the `limma` package from [Bioconductor]\r\n(https://bioconductor.org/packages/release/bioc/html/limma.html):\r\n\r\n```\r\nsource(\"http://bioconductor.org/biocLite.R\")\r\nbiocLite(\"limma\")\r\n```\r\n\r\nTo download and install this package,\r\n\r\n```\r\ninstall.packages(\"devtools\")\r\nlibrary(devtools)\r\ninstall_github(\"kkdey/CountClust\")\r\n```\r\n\r\nLoad the package in R\r\n\r\n```\r\nlibrary(CountClust)\r\n```\r\n\r\n## Application of CountClust\r\n\r\nLoad the counts data (samples along the rows, variables or features along the columns) in R. Here we use a test data comprising of the brain samples in GTEX V6 data\r\n\r\n```\r\nbrain_data <- t(data.frame(data.table::fread(\"test/cis_gene_expression_brain.txt\"))[,-(1:2)]);\r\n```\r\nNext we load the brain metadata\r\n\r\n```\r\nbrain_labels <- as.vector((read.table(\"metadata_brain.txt\")[,3]));\r\n\r\n```\r\n\r\n### Model fit \r\n\r\nWe  apply the StructureObj function to fit the topic model (due to the **maptpx** package of Matt Taddy) for clusters 2 and 3. \r\n\r\n```\r\nif(!dir.exists(\"test/Structure\")) dir.create(\"test/Structure\")\r\nStructureObj(brain_data, nclus_vec=2:3, tol=0.1, path_rda=\"test/topics_data.rda\")\r\n```\r\n\r\nThis function will output a rda file containing a list of size 2 (corresponding to clusters 2 and 3). Each element of the list is a topic model class (as defined by `topics()` function in  `maptpx` package) and contains the W (the topic proportion matrix) and T (topic distribution) files.\r\n\r\n### Cluster Visualization\r\n\r\nOne can plot the W matrix using a Structure plot. Here we provide an example of the Structure plot for K=3 for the above topic model fit. \r\n\r\n```\r\nTopic_clus <- get(load(\"topics_data.rda\"));\r\nomega <- Topic_clus$clust_3$omega;\r\n\r\nrownames(omega) <- paste0(\"X\", 1:length(brain_labels))\r\nannotation <- data.frame(\r\n  sample_id = paste0(\"X\", 1:length(brain_labels)),\r\n  tissue_label = factor(brain_labels,\r\n                        levels = rev(unique(brain_labels)) ) )\r\n\r\n\r\ncols <- c(\"blue\", \"darkgoldenrod1\", \"cyan\")\r\n\r\n\r\nStructureGGplot(omega = omega,\r\n                annotation= annotation,\r\n                palette = cols,\r\n                yaxis_label = \"\",\r\n                order_sample = TRUE,\r\n                split_line = list(split_lwd = .4,\r\n                                  split_col = \"white\"),\r\n                axis_tick = list(axis_ticks_length = .1,\r\n                                 axis_ticks_lwd_y = .1,\r\n                                 axis_ticks_lwd_x = .1,\r\n                                 axis_label_size = 10,\r\n                                 axis_label_face = \"bold\"))\r\n\r\n```\r\n\r\n<img src=\"https://github.com/kkdey/CountClust/blob/master/test/structure_plot.png\" alt=\"Structure Plot\" height=\"900\" width=\"400\">\r\n\r\n\r\n### Cluster annotations\r\n\r\nWe can extract the features that drive the clusters for K=3 as follows \r\n\r\n```\r\ntheta <- Topic_clus$clust_3$theta;\r\nfeatures <- ExtractTopFeatures(theta,top_features=50, method=\"poisson\", options=\"min\")\r\n```\r\nIt will provide you with a list of top 50 variables/features per cluster that are relatively most highly expressed in that cluster compared to the other clusters, or in other words, plays the most important role in driving or separating out that cluster from the rest. \r\n\r\n## Licenses\r\n\r\nThe CountClust package is distributed under [GPL - General Public License (>= 2)]\r\n\r\n## Contact\r\n\r\nFor any queries, contact [kkdey@uchicago.edu](kkdey@uchicago.edu)\r\n\r\n## Acknowledgements\r\n\r\n- Raman Shah\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}